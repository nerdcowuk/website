/**
 * Utility Mixins
 *
 * Reusable patterns for common CSS needs.
 */

// =========================================================================
// Accessibility
// =========================================================================

/**
 * Visually hide element while keeping it accessible to screen readers.
 */
@mixin visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/**
 * Remove visually-hidden styles.
 */
@mixin visually-hidden-reset {
    position: static;
    width: auto;
    height: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    clip: auto;
    white-space: normal;
}

/**
 * Focus ring style for keyboard navigation.
 */
@mixin focus-ring {
    outline: 2px solid var(--ncos-colour-sys-primary);
    outline-offset: 2px;
}

/**
 * Skip link styles (show on focus).
 */
@mixin skip-link {
    @include visually-hidden;

    &:focus {
        @include visually-hidden-reset;
        position: fixed;
        top: var(--ncos-spacing-small);
        left: var(--ncos-spacing-small);
        z-index: 9999;
        padding: var(--ncos-spacing-small) var(--ncos-spacing-medium);
        background: var(--ncos-colour-sys-primary);
        color: var(--ncos-colour-sys-on-primary);
        @include focus-ring;
    }
}

// =========================================================================
// Layout
// =========================================================================

/**
 * Full-bleed element that breaks out of container.
 */
@mixin full-bleed {
    width: 100vw;
    margin-left: calc(50% - 50vw);
}

/**
 * Aspect ratio container (for images, videos).
 */
@mixin aspect-ratio($width: 16, $height: 9) {
    position: relative;

    &::before {
        content: '';
        display: block;
        padding-bottom: calc(#{$height} / #{$width} * 100%);
    }

    > * {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }
}

// =========================================================================
// Typography
// =========================================================================

/**
 * Truncate text with ellipsis.
 */
@mixin truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

/**
 * Multi-line text truncation.
 */
@mixin line-clamp($lines: 2) {
    display: -webkit-box;
    -webkit-line-clamp: $lines;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

// =========================================================================
// Interactive States
// =========================================================================

/**
 * Button reset - remove default button styles.
 */
@mixin button-reset {
    appearance: none;
    background: none;
    border: none;
    padding: 0;
    margin: 0;
    font: inherit;
    color: inherit;
    cursor: pointer;

    &:disabled {
        cursor: not-allowed;
    }
}

/**
 * Link reset - remove default link styles.
 */
@mixin link-reset {
    color: inherit;
    text-decoration: none;

    &:hover,
    &:focus {
        text-decoration: none;
    }
}

/**
 * Interactive state layer (Material Design pattern).
 */
@mixin state-layer($color: currentColor) {
    position: relative;

    &::after {
        content: '';
        position: absolute;
        inset: 0;
        background: $color;
        opacity: 0;
        transition: opacity var(--ncos-transition-fast);
        pointer-events: none;
    }

    &:hover::after {
        opacity: var(--ncos-state-hover-opacity, 0.08);
    }

    &:focus-visible::after {
        opacity: var(--ncos-state-focus-opacity, 0.12);
    }

    &:active::after {
        opacity: var(--ncos-state-pressed-opacity, 0.12);
    }
}
